# errorElement

- [errorElement](#errorelement)
  - [errorElement âœ¨âœ¨âœ¨âœ¨](#errorelement-)
  - [Bubbling](#bubbling)
  - [Default Error Element](#default-error-element)
  - [Throwing Manually](#throwing-manually)
  - [Throwing Responses](#throwing-responses)
  - [Abstractions](#abstractions)

## errorElement âœ¨âœ¨âœ¨âœ¨

- loader, action ë˜ëŠ” component renderingì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ error pathë¡œ ë Œë”ë§ ë˜ê³  ì˜¤ë¥˜ëŠ” useRouterErrorë¡œ ì œê³µë¨
- react elementë¡œ ì§€ì •í•˜ê³  ì‹¶ì§€ ì•Šë‹¤ë©´, ErrorBoundary ì»´í¬ë„ŒíŠ¸ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŒ
  - ì´ëŸ´ ê²½ìš° react router ë‚´ë¶€ì ìœ¼ë¡œ createElementë¥¼ í˜¸ì¶œí•¨
- ê¸°ë³¸ ì—ëŸ¬ í˜ì´ì§€ëŠ” ë„ˆë¬´ ëª» ìƒê¹€, ìˆ˜ì •í•  ê²ƒ

```javascript
<Route
  path='/invoices/:id'
  loader={loadInvoice}
  action={updateInvoice}
  element={<Invoice />}
  errorElement={<ErrorBoundary />}
/>;

function Invoice() {
  return <div>Happy {path}</div>;
}

function ErrorBoundary() {
  let error = useRouteError();
  console.error(error);
  // Uncaught ReferenceError: path is not defined
  return <div>Dang!</div>;
}
```

## Bubbling

- í•´ë‹¹ ê²½ë¡œì— errorElementê°€ ì—†ì„ ê²½ìš° ìƒìœ„ ê²½ë¡œë¥¼ í†µí•´ ë²„ë¸”ë§ ë¨
  1. router tree ë§¨ ìœ„ì— ë°°ì¹˜í•˜ì—¬ ëŒ€ë¶€ë¶„ì˜ ì˜¤ë¥˜ë¥¼ í•œë²ˆì— ì²˜ë¦¬ [ì°¸ê³ í•  ê²ƒ](#default-error-element)
  2. ëª¨ë“  routerì— ë°°ì¹˜í•˜ê³  ì˜¤ë¥˜ê°€ ì—†ëŠ” ë¶€ë¶„ì€ ì •ìƒì ìœ¼ë¡œ ë Œë”ë§í•˜ë„ë¡ í—ˆìš©í•  ìˆ˜ ìˆìŒ
  3. nested route ì˜ childrenì— ë°°ì¹˜í•˜ì—¬ ë ˆì´ì•„ì›ƒì€ ìœ ì§€í•œ ì²´ ì˜¤ë¥˜ ì²˜ë¦¬

```javascript
createBrowserRouter([
  {
    path: '/',
    element: <Root />,
    loader: rootLoader,
    action: rootAction,
    // ì´ ë¶€ë¶„ì€ í™”ë©´ ì „ì²´ê°€ ë°”ë€œ
    errorElement: <ErrorPage />,
    children: [
      {
        // ì´ ë¶€ë¶„ì€ Root(Layout) ì•ˆì—ì„œë§Œ ë°”ë€œ
        errorElement: <ErrorPage />,
        children: [
          { index: true, element: <Index /> },
          {
            path: 'contacts/:contactId',
            element: <Contact />,
            loader: contactLoader,
            action: contactAction,
          },
        ],
      },
    ],
  },
]);
```

## Default Error Element

- errorElementë¥¼ ì œê³µí•˜ì§€ ì•Šìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ê³  error messageì™€ stack traceë¥¼ ì¸ì‡„í•˜ëŠ” ê¸°ë³¸ errorElementê°€ ì˜¤ë¥˜ë¥¼ ì²˜ë¦¬í•¨
  - ì´ê²Œ êµ‰ì¥íˆ ëª» ìƒê¹€ / status textì™€ codeë§Œ ë˜ì ¸ì¤Œ
  - stack traceê°€ í”„ë¡œë•ì…˜ ë¹Œë“œì— í‘œì‹œë˜ëŠ” ì´ìœ ? ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ ë…¸ì¶œí•˜ê¸° ì‹«ì€ë° ì™œ why
    1. **ì´ëŠ” ì„œë²„ ì¸¡ ì˜¤ë¥˜ì— ë” ì í•©í•¨(ì‹¤ì œë¡œ RemixëŠ” ì„œë²„ì¸¡ responseì—ì„œ loader/actionì—ì„œ stack traceë¥¼ ì œê±°í•¨)**
    2. client-side react-router-dom ì•±ì˜ ê²½ìš° ì½”ë“œëŠ” ì´ë¯¸ ë¸Œë¼ìš°ì €ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ìˆ¨ê¸°ëŠ” ê²ƒì€ ëª¨í˜¸í•¨ì„ í†µí•œ ë³´ì•ˆì¼ ë¿
    3. ì—¬ì „íˆ ì½˜ì†”ì— ì˜¤ë¥˜ë¥¼ ë…¸ì¶œí•˜ê³  ì‹¶ê¸° ë•Œë¬¸ì— UI í‘œì‹œì—ì„œ ì˜¤ë¥˜ë¥¼ ì œê±°í•´ë„ stack traceì— ëŒ€í•œ ì •ë³´ë¥¼ ìˆ¨ê¸°ëŠ” ê²ƒì´ ì•„ë‹˜
    4. UIì— í‘œì‹œ ë° ì½˜ì†” ë¡œê¹…ì„ í•˜ì§€ ì•Šìœ¼ë©´ ê°œë°œìê°€ í”„ë¡œë•ì…˜ ë²„ê·¸ì— ëŒ€í•œ ì •ë³´ë¥¼ ì „í˜€ ì•Œ ìˆ˜ê°€ ì—†ì–´ì„œ ì—¬ëŸ¬ ë¬¸ì œ ë°œìƒ ìš°ë ¤
    5. **ê²°ë¡  : ì‚¬ì´íŠ¸ë¥¼ í”„ë¡œë•ì…˜ í™˜ê²½ì— ë°°í¬í•˜ê¸° ì „ í•­ìƒ ë£¨íŠ¸ ìˆ˜ì¤€ì˜ errorElementë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ**

## Throwing Manually

- ì˜ˆê¸°ì¹˜ ëª»í•œ ì˜¤ë¥˜ ë¿ë§Œ ì•„ë‹ˆë¼ ì˜ˆìƒë˜ëŠ” ì˜ˆë¢°ë¥¼ ì²˜ë¦¬í•˜ëŠ”ë°ì—ë„ ì‚¬ìš© ê°€ëŠ¥
- íŠ¹íˆ loaderì™€ actionì—ì„œ ì œì–´í•  ìˆ˜ ì—†ëŠ” ì™¸ë¶€ ë°ì´í„°ë¡œ ì‘ì—…í•˜ëŠ” ê²½ìš°
  - **data**ì˜ ì¡´ì¬ ì—¬ë¶€
  - **ì„œë¹„ìŠ¤** ê°€ëŠ¥ ì—¬ë¶€
  - **ì‚¬ìš©ì ì—‘ì„¸ìŠ¤ ê¶Œí•œ**
  - ìœ„ì˜ ê²½ìš°ë“¤ë¡œì€ í•­ìƒ ê³„íší•  ìˆ˜ ì—†ìŒ

```javascript
<Route
  path='/properties/:id'
  element={<PropertyForSale />}
  errorElement={<PropertyError />}
  loader={async ({ params }) => {
    const res = await fetch(`/api/properties/${params.id}`);
    if (res.status === 404) {
      throw new Response('Not Found', { status: 404 });
    }
    const home = await res.json();
    const descriptionHtml = parseMarkdown(data.descriptionMarkdown);
    return { home, descriptionHtml };
  }}
/>
```

- ìœ„ì²˜ëŸ¼ loaderì˜ ê²½ìš° call stackì„ ì¤‘ë‹¨í•˜ê¸° ìœ„í•´ì„œ ì˜ˆì™¸ë¥¼ ë˜ì§ˆ ìˆ˜ ìˆê³  ë‚˜ë¨¸ì§€ ì‘ì—…ì— ëŒ€í•œ ê±±ì •ì—†ì´ ê·¸ëƒ¥ ì—ëŸ¬ ë˜ì§€ê³  ë‚˜ì˜¤ë©´ ë¨
- ì˜¤ë¥˜ ë¶„ê¸°ë¥¼ ê±±ì •í•  í•„ìš”ì—†ì´, loaderì™€ actionì— ë˜ì§€ë©´ ë Œë”ë§ì„ ì‹œë„í•˜ì§€ ì•Šê³  errorElementê°€ ì•Œì•„ì„œ ë Œë”ë§
- ìœ„ ì˜ˆì œì²˜ëŸ¼ response, error, ì¼ë°˜ ê°ì²´ ë“± ë¬´ì—‡ì´ë“  return ê°€ëŠ¥í•˜ë¯€ë¡œ loaderë‚˜ actionì—ì„œ ë­ë“ ì§€ ë˜ì§ˆ ìˆ˜ ìˆìŒ

## Throwing Responses

- Responseë¥¼ ë˜ì§ˆ ê²½ìš° ìë™ìœ¼ë¡œ response dataë¥¼ íŒŒì‹±í•œ í›„ ì»´í¬ë„ŒíŠ¸ë¥¼ ë°˜í™˜í•¨
- isRouteErrorResponseë¥¼ ì‚¬ìš©í•˜ë©´ ë°”ìš´ë”ë¦¬ì—ì„œ ì´ íŠ¹ì • ìœ í˜•ì„ í™•ì¸í•  ìˆ˜ ìˆìŒ
  - jsonê³¼ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ì¼ë¶€ ë°ì´í„°ê°€ í¬í•¨ëœ responseë¥¼ ì‰½ê²Œ ë˜ì§€ê³  ë°”ìš´ë”ë¦¬ì—ì„œ ë‹¤ì–‘í•œ ê²½ìš°ë¥¼ ë Œë”ë§ í•  ìˆ˜ ìˆìŒ

```javascript
import { json } from "react-router-dom";

function loader() {
  const stillWorksHere = await userStillWorksHere();
  if (!stillWorksHere) {
    throw json(
      {
        sorry: "You have been fired.",
        hrEmail: "hr@bigco.com",
      },
      { status: 401 }
    );
  }
}

function ErrorBoundary() {
  const error = useRouteError();

  if (isRouteErrorResponse(error) && error.status === 401) {
    // response jsonì€ ìë™ìœ¼ë¡œ íŒŒì‹±ë˜ì–´ error.dataë¡œ ì „ë‹¬ë˜ statusì—ë„ access ê°€ëŠ¥
    return (
      <div>
        <h1>{error.status}</h1>
        <h2>{error.data.sorry}</h2>
        <p>
          Go ahead and email {error.data.hrEmail} if you
          feel like this is a mistake.
        </p>
      </div>
    );
  }

  // ì´ routeì— ëŒ€í•œ íŠ¹ë³„í•œ ê²½ìš°ê°€ ì•„ë‹Œ ê²½ìš°
  // ë‹¤ì‹œ ë˜ì ¸ì„œ parent error boundaryë¥¼ í•¸ë“¤ë§í•˜ë„ë¡ í•¨
  throw error;
}
```

- ì´ëŸ´ ê²½ìš° ì¼ë°˜ì ìœ¼ë¡œ root routeì— ë§ì€ ê²½ìš°ë¥¼ ì²˜ë¦¬í•˜ëŠ” error boundaryë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŒ

```javascript
function RootBoundary() {
  const error = useRouteError();

  if (isRouteErrorResponse(error)) {
    if (error.status === 404) {
      return <div>This page doesn't exist!</div>;
    }

    if (error.status === 401) {
      return <div>You aren't authorized to see this</div>;
    }

    if (error.status === 503) {
      return <div>Looks like our API is down</div>;
    }

    if (error.status === 418) {
      return <div>ğŸ«–</div>;
    }
  }

  return <div>Something went wrong</div>;
}
```

## Abstractions

- í˜„ì¬ ì§„í–‰ ì¤‘ì¸ data loading pathë¥¼ ê³„ì† ì§„í–‰í•  ìˆ˜ ì—†ì„ ê²½ìš° ë˜ì§€ëŠ” íŒ¨í„´
- ì˜ˆì™¸ì ì¸ ìƒí™©ì„ ì ì ˆíˆ ì²˜ë¦¬í•˜ëŠ” ë° ë§¤ìš° ê°„ë‹¨
- [ì˜ˆì œ ì½”ë“œ](https://reactrouter.com/en/main/route/error-element#abstractions)
